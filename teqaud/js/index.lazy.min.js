"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}var Footer=function(){function t(e){_classCallCheck(this,t),this.$element=e,this.$mobileToDesktop=this.$element.find(".js-mobile-to-desktop"),this.$footerBottom=this.$element.find(".js-footer__bottom"),this.cookieName="agima_mobile_to_desktop",this.getMainCookie(this.cookieName)&&this.toggleMode(),this.setListeners()}return _createClass(t,[{key:"setListeners",value:function(){var t=this;this.$mobileToDesktop.on("click",function(e){e.preventDefault(),document.body.scrollTop=0,t.toggleMode()})}},{key:"setMainCookie",value:function(e,t,i){var n="";if(i){var s=new Date;s.setTime(s.getTime()+24*i*60*60*1e3),n="; expires="+s.toUTCString()}document.cookie=e+"="+(t||"")+n+"; path=/"}},{key:"getMainCookie",value:function(e){var i=e+"=",t=String(document.cookie).split(";"),n=null;return _.each(t,function(e){var t=_.trim(e);t.startsWith(i)&&(n=t.substring(i.length,e.length))}),n}},{key:"toggleMode",value:function(){var e=this.$mobileToDesktop.attr("data-invert-text");this.$mobileToDesktop.attr("data-invert-text",this.$mobileToDesktop.html()),this.$mobileToDesktop.html(e),$("body").toggleClass("is-fake-desktop"),$("body").hasClass("is-fake-desktop")?(this.setMainCookie(this.cookieName,!0,7),$("meta[name=viewport]").attr("content","width=1024px, initial-scale=1.0")):(document.cookie=this.cookieName+"=; Max-Age=-99999999;",$("meta[name=viewport]").attr("content","width=device-width, initial-scale=1.0"))}}]),t}();setTimeout(function(){$(".js-footer").each(function(e,t){new Footer($(t))})},0);var Project=function(){function t(e){_classCallCheck(this,t),this.$element=e,this.$tabsLinks=$(".js-go-to-section"),this.$fixedMenu=$(".js-projects-fixed-menu"),this.$tabsLinksInFixedMenu=this.$fixedMenu.find(".js-go-to-section"),this.$header=$(".js-header"),this.$limiter=$(".js-show-fixed-menu"),this.$context=this.$element.find(".js-projects-context"),this.videos=document.querySelectorAll(".js-projects-video"),this.previews=document.querySelectorAll(".js-project-preview"),this.startX=null,this.cache={},this.content="",this.scrolled=!1,this.moreTrigger=$(".js-project-more-trigger"),this.$tabsLinksInFixedMenuIdArray=_.map(this.$tabsLinksInFixedMenu,function(e){return e.getAttribute("href")}),this.initVideos(),this.initHovers(),this.initJsReady(),this.setListeners()}return _createClass(t,[{key:"initJsReady",value:function(){this.cache["/projects/?filter=all"]=this.$context[0].innerHTML,_.each(this.$context,function(e){_.each(e.children,function(e){_.each(e.children,function(e){"UL"===e.tagName?_.each(e.children,function(e){e.classList.add("js-is-ready")}):e.classList.add("js-is-ready")})})})}},{key:"setListeners",value:function(){var o=this;$(window).on("scroll",_.throttle(function(e){o.checkScroll()},250)),this.moreTrigger.on("click",function(e){e.preventDefault(),o.moreTrigger.parent().hide(),o.$element.find(".projects__wrapper.h-hide").removeClass("h-hide")}),_.forEach(this.$tabsLinks,function(s){$(s).on("click",function(e){e.preventDefault(),o.content="";var t="all"!==$(s).attr("href")?$(s).attr("href"):"",i="/projects/".concat(t,"?ajax=y");if(o.cache[i])o.content=o.cache[i],o.$context.css("opacity","0"),o.contentInit(),history.pushState(null,null,"/projects/".concat("all"!==$(s).attr("href")?$(s).attr("href"):""));else{var n=new XMLHttpRequest;n.open("GET",i),n.onload=function(){o.content=n.response,o.cache[i]=n.response,o.$context.css("opacity","0"),o.contentInit(),history.pushState(null,null,"/projects/".concat("all"!==$(s).attr("href")?$(s).attr("href"):""))},n.send()}_.forEach(o.$tabsLinks,function(e){$(e).removeClass("is-active"),$(e).attr("href")!==$(s).attr("href")||$(e).hasClass("is-active")||$(e).addClass("is-active")}),$(s).addClass("is-active")})})}},{key:"contentInit",value:function(){var e=this;setTimeout(function(){e.$context[0].innerHTML=e.content,new IsReady($(".js-is-ready")),$(".js-adaptive-background-image").each(function(e,t){return new AdaptiveBackgroundImage($(t))}),new Images,e.$context.css("opacity","1")},300)}},{key:"initVideos",value:function(){481<window.innerWidth&&this.videos.forEach(function(e){var t=e.parentElement.parentElement,i=t.querySelector(".js-project-desc"),n=t.querySelector(".card__text");e.parentElement.addEventListener("mouseenter",function(){e.play(),i.classList.add("_hover")}),e.parentElement.addEventListener("mouseleave",function(){e.pause(),i.classList.remove("_hover")}),n&&(n.addEventListener("mouseenter",function(){e.play()}),n.addEventListener("mouseleave",function(){e.pause()}))})}},{key:"initHovers",value:function(){this.previews.forEach(function(e){var t=e.parentElement.querySelector(".js-project-desc"),i=e.parentElement.querySelector(".card__text");i&&(i.addEventListener("mouseenter",function(){e.classList.add("_hover")}),i.addEventListener("mouseleave",function(){e.classList.remove("_hover")})),e.addEventListener("mouseenter",function(){t.classList.add("_hover")}),e.addEventListener("mouseleave",function(){t.classList.remove("_hover")})})}},{key:"isVisible",value:function(e){return window.pageYOffset>window.pageYOffset+e.getBoundingClientRect().top-window.innerHeight&&window.pageYOffset<window.pageYOffset+e.getBoundingClientRect().bottom}},{key:"checkScroll",value:function(){window.pageYOffset>=this.$limiter.offset().top-this.$header.height()?this.$fixedMenu.addClass("is-active"):this.$fixedMenu.removeClass("is-active")}}]),t}();$(function(){$(".js-projects").each(function(e,t){new Project($(t))})});var PromoAbout=function(){function t(e){_classCallCheck(this,t),this.$element=e,this.$readies=this.$element.find(".js-is-ready:not(.js-no-animate-counters)"),this.$video=this.$element.find(".js-video-parallax"),this.canAnimate=!0,this.setListeners()}return _createClass(t,[{key:"setListeners",value:function(){var t=this;this.$readies.on("is-ready",function(e){t.canAnimate&&t.animateCounters($(e.currentTarget).find(".js-animate-counter"))})}},{key:"animateCounters",value:function(e){var n=this;_.each(e,function(e){var t=parseInt(e.getAttribute("data-end")),i={number:0};anime({targets:i,number:{value:t,duration:2e3+2.5*t,easing:"easeOutExpo"},update:function(){e.innerHTML=parseInt(i.number),n.canAnimate=!1}})})}}]),t}();setTimeout(function(){$(".js-promo-about").each(function(e,t){new PromoAbout($(t))})},0);var VideoWrapper=function(){function t(e){_classCallCheck(this,t),this.$element=e,this.$play=this.$element.find(".js-play"),this.$popup=this.$element.find(".js-video-popup"),this.setListeners()}return _createClass(t,[{key:"setListeners",value:function(){this.$play.off("click",this.onPlayClick),this.$play.on("click",this.onPlayClick)}},{key:"onPlayClick",value:function(e){e.preventDefault();var t=$(this).closest(".js-video-wrapper").find(".js-video-popup").clone(!0);t.removeClass("is-hidden"),$("body").append(t);var i=$(t).find("iframe")[0];if(i){var n=$(i).attr("data-src")||$(i).attr("src")||"";0<n.indexOf("?")&&(n=n.slice(0,n.indexOf("?"))),$(i).attr("allow","autoplay"),i.setAttribute("src",""),i.setAttribute("src",n+"?autoplay=1")}else $(t).find("video")[0].play();t.on("click",function(e){"video"!==e.target.tagName.toLowerCase()&&t.remove()}),$(window).on("keydown",function(e){27==e.which&&t.trigger("click")})}}]),t}();setTimeout(function(){$(".js-video-wrapper").each(function(e,t){new VideoWrapper($(t))})},0);var TrustUs=function(){function t(e){_classCallCheck(this,t),this.$element=e,this.$logos=this.$element.find(".js-trust-us-logos"),this.$container=this.$element.find(".js-trust-us-container"),this.setListeners()}return _createClass(t,[{key:"setListeners",value:function(){var t=this;$(window).on("scroll",function(e){t.$container[0].style="transform: translateY(".concat((t.$logos.offset().top-window.pageYOffset-parseInt(t.$logos.css("height"),10))/4,"px)")})}}]),t}();setTimeout(function(){$(".js-trust-us").each(function(e,t){new TrustUs($(t))})},0);var SpecialProjectsSlider=function(){function t(e){_classCallCheck(this,t),this.$element=e,this.$slider=this.$element.find(".js-slider"),this.$slides=this.$element.find(".js-slide"),this.$dots=this.$element.find(".js-dot"),this.currentIndex=0,this.setListeners()}return _createClass(t,[{key:"setListeners",value:function(){var i=this;this.changeSlide(),_.each(this.$dots,function(e,t){$(e).on("click",function(e){e.preventDefault(),i.currentIndex=t,i.changeSlide()})}),$(window).on("resize",function(e){i.changeSlide()}),this.$slides.on("click",function(e){$(e.target).hasClass("js-play")||(i.currentIndex++,i.currentIndex>i.$slides.length-1&&(i.currentIndex=0),i.changeSlide())})}},{key:"changeSlide",value:function(){1024<=window.innerWidth?(this.$slides.removeClass("is-active"),this.$dots.removeClass("is-active"),this.$slides.eq(this.currentIndex).addClass("is-active"),this.$dots.eq(this.currentIndex).addClass("is-active")):(this.$slides.addClass("is-active"),this.$dots.removeClass("is-active"),this.$dots.eq(this.currentIndex).addClass("is-active"),anime({targets:this.$slider[0],scrollLeft:{value:this.$slider.width()*this.currentIndex,duration:500,easing:"easeInOutCirc"}}))}}]),t}();setTimeout(function(){$(".js-special-projects").each(function(e,t){new SpecialProjectsSlider($(t))})},0);var BlogComponentSlider=function(){function t(e){_classCallCheck(this,t),this.$element=e,this.$slider=this.$element.find(".js-slider"),this.$slides=this.$slider.find(".js-slide"),this.$left=this.$element.find(".js-left"),this.$right=this.$element.find(".js-right"),this.$pagination=this.$element.find(".js-pagination"),this.currentIndex=0,this.canAnimate=!0,this.startX=null,this.setListeners(),this.updatePager()}return _createClass(t,[{key:"setListeners",value:function(){var n=this;this.$left.on("click",function(e){e.preventDefault(),n.canAnimate&&(n.canAnimate=!1,n.currentIndex--,n.currentIndex<0&&(n.currentIndex=0),n.moveSlider())}),this.$right.on("click",function(e){e.preventDefault(),n.canAnimate&&(n.canAnimate=!1,n.currentIndex++,n.currentIndex>n.$slides.length-1&&(n.currentIndex=n.$slides.length-1),n.moveSlider())}),this.$slides.on("click",function(e){n.canAnimate&&!$(e.target).hasClass("js-play")&&(n.canAnimate=!1,n.currentIndex++,n.currentIndex>n.$slides.length-1&&(n.currentIndex=n.$slides.length-1),n.moveSlider())}),this.$slider.on("touchstart",function(e){n.startX=(e.touches||e.originalEvent.touches)[0].clientX,n.startY=(e.touches||e.originalEvent.touches)[0].clientY}),this.$slider.on("touchmove",function(e){if(n.startX){var t=n.startX-(e.touches||e.originalEvent.touches)[0].clientX,i=n.startY-(e.touches||e.originalEvent.touches)[0].clientY;15<t&&i<100&&-100<i?(n.$right.trigger("click"),n.startX=null):t<-15&&i<100&&-100<i&&(n.$left.trigger("click"),n.startX=null)}}),window.addEventListener("resize",function(){n.$slider[0]&&(n.$slider[0].scrollLeft=n.$slider.width()*n.currentIndex)}),$(document.body).on("keydown",function(e){var t=n.$element.find(".js-slider").eq(0);if(t.offset()&&window.pageYOffset+window.innerHeight>t.offset().top&&window.pageYOffset<t.offset().top+t.height())switch(e.which){case 37:n.$left.trigger("click");break;case 39:n.$right.trigger("click")}})}},{key:"updatePager",value:function(){this.$pagination.html("<span>"+(this.currentIndex+1)+"</span> <i>/</i> "+this.$slides.length)}},{key:"moveSlider",value:function(){var e=this;anime({targets:this.$slider[0],scrollLeft:{value:this.$slider.width()*this.currentIndex+.5,duration:500,easing:"easeInOutCirc"},complete:function(){e.canAnimate=!0,e.updatePager()}})}}]),t}();setTimeout(function(){$(".js-blog-component").each(function(e,t){new BlogComponentSlider($(t))})},0);